---
title: Flow123d - Transport
layout: page
---

<h1>
  Advection-Diffusion Equation for Solute Transport
</h1>

<p>
  Flow123d can simulate the motion of substances dissolved in water through fractured rock massif. The transport mechanism is due to the advection of water, and the hydrodynamic diffusion/dispersion. Concentration of arbitrary number of substances can be predicted starting from given initial state, with options for time-dependent concentration sources and boundary fluxes. Currently Flow123d provides two algorithms for solute transport:
</p>

<h3>
  1. Pure advection is modelled using Finite volume method with explicit timestepping.
</h3>
<ul>
  <li>
    Fast way to obtain time evolution of concentrations
  </li>
  <li>
    Exact satisfaction of discrete maximum principle (no under/overshoots) 
  </li>
  <li>
    Automatic choice of time step to guarantee stability 
  </li>
</ul>

<h3>
  2. Full model including advection and hydrodynamic diffusion is solved by <strong>Discontinuous Galerkin method and implicit timestepping</strong>, which offers:
</h3>
<ul>
  <li>
    <em>Stability:</em> significantly reduced spurious oscillations (compared to traditional FEM), no limiting CFL conditions
  </li>
  <li>
    <em>Robustness:</em> accurate results both in advection dominated and diffusion dominated regimes, easy setup (no "magic" parameters) 
  </li>
  <li>
    <em>High order accuracy:</em> currently support for piecewise linear and quadratic base functions 
  </li>
  <li>
    <em>Flexibility:</em> user can enforce inter-element continuity of solution to produce results close to FEM
  </li>
</ul>

<h2>Examples</h2>

<h3> Comparison of Numerical Schemes for Solute Transport</h3>

<p>
  Comparison of Finite volume (FV), Finite element (FE) and Discontinuous Galerkin (DG) method for solution of travelling wave problem. The exact solution is piecewice constant in 3 regions.
</p>

<p>
  Despite lower order accuracy and significant dissipation (smoothing effect), FV solution still appears physical and preserves the maximum principle. FE solution (obtained as a limit case of DG with strong enforcement of inter-element continuity) suffers from spurious oscillations spread throughout the computational domain. DG solution (2nd order polynomial approximation), though discontinuous, turns out to be less dissipative than FV and resistant to instabilities. 
</p>


<div class="picture">
  <video controls width="596" height="548" poster="/videos/1d-wave-poster.png" >
    <source src="/gallery/videos/1d-wave.ogv" type="video/ogg" />
    <source src="/gallery/videos/1d-wave.mov" type="video/mov" />
    Your device does not support HTML5 video.
  </video>
  <br/>
  <i>Animation: Comparision of numerical schemes for solute transport</i>
</div>

<h3>Solute Transport in 2D Fractured Medium</h3>

<p>
  2D example of transport in fractured medium: The substance moves to the left because of pressure gradient. The concentration in some distant zones raises rapidly due to higher conductivity of fractures.
</p>

<div class="picture">
  <video controls width="576" height="368" poster="/videos/test2d-poster.png" >
    <source src="/gallery/videos/test2d.ogv" type="video/ogg" />
    <source src="/gallery/videos/test2d.mp4" type="video/mp4" />
    Your device does not support HTML5 video.
  </video>
  <br/>
  <i>Animation: Solute transport in 2D fractured medium</i>
</div>